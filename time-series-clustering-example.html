<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>e6969784ff80417eade8493db6ad0757</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" id="-O1hCDBc8JWc">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install yfinance</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install tslearn</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2" id="7iTOYULN8O06">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_datareader.data <span class="im">as</span> web</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>yf.pdr_override()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3" id="RMLg_awH8XAH">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tslearn.clustering <span class="im">import</span> TimeSeriesKMeans</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tslearn.datasets <span class="im">import</span> CachedDatasets</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tslearn.preprocessing <span class="im">import</span> TimeSeriesScalerMeanVariance, TimeSeriesResampler</span></code></pre></div>
</div>
<div class="cell code" id="vn-8LafQ8YCv">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tickers <span class="op">=</span> pd.read_csv(<span class="st">&quot;SP500.csv&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tickers <span class="op">=</span> tickers.Symbol.to_list()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> dt.datetime(<span class="dv">2021</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> dt.datetime(<span class="dv">2021</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> yf.download(tickers[:<span class="dv">100</span>], start<span class="op">=</span>start, end<span class="op">=</span>end)[<span class="st">&#39;Adj Close&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="15" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="RN0ANrfc9N3_" data-outputId="3db2459e-2ee2-4d79-b0fb-bfaf2b3d4910">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.reset_index()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data.drop(<span class="st">&#39;Date&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.dropna(how<span class="op">=</span><span class="st">&#39;all&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(data.columns))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.fillna(<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>82
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16" data-colab="{&quot;height&quot;:750,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="TZLf4DMT8utn" data-outputId="f8cf15b6-ed93-458e-c925-de83fbdc874c">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-6869eb4d-5459-49ce-9626-cb539b806dbb">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>AAL</th>
      <th>AAP</th>
      <th>AAPL</th>
      <th>ABBV</th>
      <th>ABC</th>
      <th>ABT</th>
      <th>ACN</th>
      <th>ADBE</th>
      <th>ADI</th>
      <th>...</th>
      <th>COF</th>
      <th>CPB</th>
      <th>GOOG</th>
      <th>GOOGL</th>
      <th>HRB</th>
      <th>KMX</th>
      <th>LNT</th>
      <th>MMM</th>
      <th>MO</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>...</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>117.608414</td>
      <td>15.130000</td>
      <td>151.113617</td>
      <td>128.087097</td>
      <td>97.798592</td>
      <td>94.156944</td>
      <td>106.174484</td>
      <td>251.030594</td>
      <td>485.339996</td>
      <td>141.584396</td>
      <td>...</td>
      <td>94.769386</td>
      <td>45.866257</td>
      <td>86.412003</td>
      <td>86.306503</td>
      <td>14.601637</td>
      <td>93.300003</td>
      <td>47.971268</td>
      <td>161.677658</td>
      <td>35.854099</td>
      <td>19.144424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>118.569984</td>
      <td>15.430000</td>
      <td>150.950348</td>
      <td>129.670715</td>
      <td>98.809883</td>
      <td>95.386353</td>
      <td>107.488159</td>
      <td>252.459732</td>
      <td>485.690002</td>
      <td>144.115112</td>
      <td>...</td>
      <td>96.997200</td>
      <td>46.215942</td>
      <td>87.045998</td>
      <td>87.002502</td>
      <td>14.760147</td>
      <td>94.199997</td>
      <td>47.743237</td>
      <td>161.404877</td>
      <td>35.783867</td>
      <td>19.027372</td>
    </tr>
    <tr>
      <th>3</th>
      <td>121.821472</td>
      <td>15.520000</td>
      <td>159.670990</td>
      <td>125.305801</td>
      <td>97.956314</td>
      <td>103.592155</td>
      <td>107.264359</td>
      <td>255.219955</td>
      <td>466.309998</td>
      <td>144.764755</td>
      <td>...</td>
      <td>104.009979</td>
      <td>45.280285</td>
      <td>86.764503</td>
      <td>86.143997</td>
      <td>15.067845</td>
      <td>97.959999</td>
      <td>48.455822</td>
      <td>163.860077</td>
      <td>36.363289</td>
      <td>19.398035</td>
    </tr>
    <tr>
      <th>4</th>
      <td>125.063026</td>
      <td>15.380000</td>
      <td>161.034836</td>
      <td>129.581635</td>
      <td>99.004723</td>
      <td>107.456001</td>
      <td>108.305565</td>
      <td>257.627930</td>
      <td>477.739990</td>
      <td>150.883072</td>
      <td>...</td>
      <td>107.254845</td>
      <td>44.975498</td>
      <td>89.362503</td>
      <td>88.717003</td>
      <td>14.834742</td>
      <td>100.300003</td>
      <td>46.660103</td>
      <td>159.655167</td>
      <td>36.679337</td>
      <td>19.450060</td>
    </tr>
    <tr>
      <th>5</th>
      <td>125.955200</td>
      <td>15.130000</td>
      <td>163.330261</td>
      <td>130.700073</td>
      <td>99.524277</td>
      <td>107.358429</td>
      <td>108.607231</td>
      <td>258.567596</td>
      <td>485.100006</td>
      <td>151.978760</td>
      <td>...</td>
      <td>107.090172</td>
      <td>44.632610</td>
      <td>90.360497</td>
      <td>89.891502</td>
      <td>14.834742</td>
      <td>102.099998</td>
      <td>46.888130</td>
      <td>156.738998</td>
      <td>36.512535</td>
      <td>19.315926</td>
    </tr>
    <tr>
      <th>6</th>
      <td>127.035713</td>
      <td>15.000000</td>
      <td>164.252258</td>
      <td>127.661469</td>
      <td>101.147926</td>
      <td>104.743500</td>
      <td>107.857925</td>
      <td>254.838257</td>
      <td>474.239990</td>
      <td>153.491379</td>
      <td>...</td>
      <td>105.879402</td>
      <td>43.842060</td>
      <td>88.335999</td>
      <td>87.814499</td>
      <td>15.039871</td>
      <td>104.639999</td>
      <td>46.128044</td>
      <td>155.403214</td>
      <td>36.301834</td>
      <td>19.216084</td>
    </tr>
    <tr>
      <th>7</th>
      <td>125.865982</td>
      <td>15.380000</td>
      <td>169.678665</td>
      <td>127.483315</td>
      <td>101.853043</td>
      <td>103.933647</td>
      <td>105.911751</td>
      <td>252.929520</td>
      <td>471.649994</td>
      <td>154.257385</td>
      <td>...</td>
      <td>107.283897</td>
      <td>43.327728</td>
      <td>87.327499</td>
      <td>86.871498</td>
      <td>15.254329</td>
      <td>106.500000</td>
      <td>45.633984</td>
      <td>156.635513</td>
      <td>35.933102</td>
      <td>19.136213</td>
    </tr>
    <tr>
      <th>8</th>
      <td>125.875908</td>
      <td>15.530000</td>
      <td>164.962967</td>
      <td>129.551941</td>
      <td>104.330254</td>
      <td>103.055519</td>
      <td>109.132690</td>
      <td>252.497345</td>
      <td>472.049988</td>
      <td>153.665878</td>
      <td>...</td>
      <td>108.562469</td>
      <td>43.270580</td>
      <td>87.720001</td>
      <td>87.362503</td>
      <td>15.328922</td>
      <td>105.489998</td>
      <td>46.318062</td>
      <td>156.419174</td>
      <td>36.073574</td>
      <td>19.043026</td>
    </tr>
    <tr>
      <th>9</th>
      <td>124.934151</td>
      <td>16.440001</td>
      <td>162.148941</td>
      <td>127.592178</td>
      <td>104.780792</td>
      <td>103.075020</td>
      <td>107.510841</td>
      <td>250.454453</td>
      <td>463.269989</td>
      <td>154.616150</td>
      <td>...</td>
      <td>110.809662</td>
      <td>43.689663</td>
      <td>87.009003</td>
      <td>86.545998</td>
      <td>15.030549</td>
      <td>106.349998</td>
      <td>45.690994</td>
      <td>156.541443</td>
      <td>36.091137</td>
      <td>19.495638</td>
    </tr>
    <tr>
      <th>10</th>
      <td>125.112587</td>
      <td>15.760000</td>
      <td>158.710587</td>
      <td>125.840279</td>
      <td>103.738899</td>
      <td>104.206856</td>
      <td>108.741890</td>
      <td>249.128510</td>
      <td>458.079987</td>
      <td>152.958054</td>
      <td>...</td>
      <td>108.998352</td>
      <td>44.213520</td>
      <td>86.809502</td>
      <td>86.380997</td>
      <td>15.384866</td>
      <td>106.440002</td>
      <td>47.002148</td>
      <td>155.732468</td>
      <td>36.170151</td>
      <td>19.415764</td>
    </tr>
    <tr>
      <th>11</th>
      <td>126.242676</td>
      <td>15.970000</td>
      <td>159.363693</td>
      <td>126.523224</td>
      <td>105.297058</td>
      <td>100.986992</td>
      <td>109.982697</td>
      <td>251.279465</td>
      <td>456.500000</td>
      <td>155.663315</td>
      <td>...</td>
      <td>109.318008</td>
      <td>44.175426</td>
      <td>89.542999</td>
      <td>89.223503</td>
      <td>15.300949</td>
      <td>116.430000</td>
      <td>47.154167</td>
      <td>159.090759</td>
      <td>36.196480</td>
      <td>19.269331</td>
    </tr>
    <tr>
      <th>12</th>
      <td>126.996071</td>
      <td>16.170000</td>
      <td>158.643356</td>
      <td>130.680298</td>
      <td>105.710068</td>
      <td>101.269943</td>
      <td>110.295341</td>
      <td>257.005585</td>
      <td>469.730011</td>
      <td>154.974899</td>
      <td>...</td>
      <td>107.884445</td>
      <td>43.851585</td>
      <td>94.345001</td>
      <td>94.003502</td>
      <td>15.739184</td>
      <td>122.790001</td>
      <td>47.429699</td>
      <td>160.125504</td>
      <td>36.960270</td>
      <td>19.275988</td>
    </tr>
    <tr>
      <th>13</th>
      <td>125.895721</td>
      <td>15.830000</td>
      <td>160.084000</td>
      <td>135.470825</td>
      <td>104.433502</td>
      <td>102.362747</td>
      <td>110.353951</td>
      <td>253.342056</td>
      <td>472.019989</td>
      <td>154.451263</td>
      <td>...</td>
      <td>105.133575</td>
      <td>44.404015</td>
      <td>94.562500</td>
      <td>94.207497</td>
      <td>15.543377</td>
      <td>120.290001</td>
      <td>47.268185</td>
      <td>160.548859</td>
      <td>36.819809</td>
      <td>19.189459</td>
    </tr>
    <tr>
      <th>14</th>
      <td>125.231560</td>
      <td>15.820000</td>
      <td>157.279556</td>
      <td>137.648331</td>
      <td>104.058044</td>
      <td>105.143555</td>
      <td>110.246475</td>
      <td>250.228546</td>
      <td>472.440002</td>
      <td>150.853989</td>
      <td>...</td>
      <td>102.033997</td>
      <td>44.365921</td>
      <td>95.052498</td>
      <td>94.627998</td>
      <td>15.552705</td>
      <td>118.639999</td>
      <td>46.945145</td>
      <td>159.015503</td>
      <td>36.723236</td>
      <td>19.256021</td>
    </tr>
    <tr>
      <th>15</th>
      <td>124.388947</td>
      <td>15.430000</td>
      <td>153.341812</td>
      <td>141.458969</td>
      <td>103.720131</td>
      <td>104.275162</td>
      <td>112.083290</td>
      <td>247.547195</td>
      <td>473.440002</td>
      <td>149.050476</td>
      <td>...</td>
      <td>99.312195</td>
      <td>45.718422</td>
      <td>94.970001</td>
      <td>94.713997</td>
      <td>15.748508</td>
      <td>120.959999</td>
      <td>47.980766</td>
      <td>160.285446</td>
      <td>36.837360</td>
      <td>19.375828</td>
    </tr>
    <tr>
      <th>16</th>
      <td>122.842499</td>
      <td>15.530000</td>
      <td>151.392151</td>
      <td>141.696518</td>
      <td>102.124435</td>
      <td>106.197319</td>
      <td>112.093063</td>
      <td>248.480270</td>
      <td>476.279999</td>
      <td>150.233444</td>
      <td>...</td>
      <td>96.793793</td>
      <td>47.575733</td>
      <td>95.862000</td>
      <td>95.397499</td>
      <td>17.193754</td>
      <td>127.790001</td>
      <td>47.353687</td>
      <td>165.515717</td>
      <td>37.074402</td>
      <td>19.801819</td>
    </tr>
    <tr>
      <th>17</th>
      <td>117.767021</td>
      <td>16.559999</td>
      <td>142.075989</td>
      <td>140.607758</td>
      <td>96.483185</td>
      <td>104.245872</td>
      <td>111.663170</td>
      <td>241.713120</td>
      <td>460.000000</td>
      <td>143.000000</td>
      <td>...</td>
      <td>99.467178</td>
      <td>50.204540</td>
      <td>91.539497</td>
      <td>90.946999</td>
      <td>17.324293</td>
      <td>121.449997</td>
      <td>46.536594</td>
      <td>175.581161</td>
      <td>36.714451</td>
      <td>19.395798</td>
    </tr>
    <tr>
      <th>18</th>
      <td>120.503014</td>
      <td>18.100000</td>
      <td>147.271912</td>
      <td>135.688553</td>
      <td>97.816055</td>
      <td>104.304436</td>
      <td>117.622963</td>
      <td>244.895340</td>
      <td>465.670013</td>
      <td>144.677505</td>
      <td>...</td>
      <td>103.486916</td>
      <td>46.432774</td>
      <td>93.155502</td>
      <td>92.660004</td>
      <td>16.391876</td>
      <td>121.290001</td>
      <td>46.903496</td>
      <td>172.542725</td>
      <td>37.443130</td>
      <td>19.169491</td>
    </tr>
    <tr>
      <th>19</th>
      <td>119.125107</td>
      <td>17.170000</td>
      <td>143.238129</td>
      <td>130.610992</td>
      <td>96.192200</td>
      <td>101.669983</td>
      <td>120.749405</td>
      <td>237.607605</td>
      <td>458.769989</td>
      <td>142.854599</td>
      <td>...</td>
      <td>100.987907</td>
      <td>45.823193</td>
      <td>91.787003</td>
      <td>91.367996</td>
      <td>16.065533</td>
      <td>117.779999</td>
      <td>46.606525</td>
      <td>165.242905</td>
      <td>36.064796</td>
      <td>19.056337</td>
    </tr>
  </tbody>
</table>
<p>20 rows × 82 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6869eb4d-5459-49ce-9626-cb539b806dbb')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6869eb4d-5459-49ce-9626-cb539b806dbb button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6869eb4d-5459-49ce-9626-cb539b806dbb');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="17" id="YnDoAiuR8aV3">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_list <span class="op">=</span> []</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> splitter(frame,df_list):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> frame.empty:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> frame.iloc[:<span class="dv">5</span>]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    df_list.append(df)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    splitter(frame.iloc[<span class="dv">5</span>:],df_list)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span>:</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18" id="pkLEasSR8rkn">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>splitter(data,df_list)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="1n0D2Xn98wqu" data-outputId="c78625df-a067-49ba-8f66-6904349b4a28">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_list</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>[            A    AAL         AAP        AAPL       ABBV         ABC  \
 0   -1.000000  -1.00   -1.000000   -1.000000  -1.000000   -1.000000   
 1  117.608414  15.13  151.113617  128.087097  97.798592   94.156944   
 2  118.569984  15.43  150.950348  129.670715  98.809883   95.386353   
 3  121.821472  15.52  159.670990  125.305801  97.956314  103.592155   
 4  125.063026  15.38  161.034836  129.581635  99.004723  107.456001   
 
           ABT         ACN        ADBE         ADI  ...         COF        CPB  \
 0   -1.000000   -1.000000   -1.000000   -1.000000  ...   -1.000000  -1.000000   
 1  106.174484  251.030594  485.339996  141.584396  ...   94.769386  45.866257   
 2  107.488159  252.459732  485.690002  144.115112  ...   96.997200  46.215942   
 3  107.264359  255.219955  466.309998  144.764755  ...  104.009979  45.280285   
 4  108.305565  257.627930  477.739990  150.883072  ...  107.254845  44.975498   
 
         GOOG      GOOGL        HRB         KMX        LNT         MMM  \
 0  -1.000000  -1.000000  -1.000000   -1.000000  -1.000000   -1.000000   
 1  86.412003  86.306503  14.601637   93.300003  47.971268  161.677658   
 2  87.045998  87.002502  14.760147   94.199997  47.743237  161.404877   
 3  86.764503  86.143997  15.067845   97.959999  48.455822  163.860077   
 4  89.362503  88.717003  14.834742  100.300003  46.660103  159.655167   
 
           MO          T  
 0  -1.000000  -1.000000  
 1  35.854099  19.144424  
 2  35.783867  19.027372  
 3  36.363289  19.398035  
 4  36.679337  19.450060  
 
 [5 rows x 82 columns],
             A        AAL         AAP        AAPL        ABBV         ABC  \
 5  125.955200  15.130000  163.330261  130.700073   99.524277  107.358429   
 6  127.035713  15.000000  164.252258  127.661469  101.147926  104.743500   
 7  125.865982  15.380000  169.678665  127.483315  101.853043  103.933647   
 8  125.875908  15.530000  164.962967  129.551941  104.330254  103.055519   
 9  124.934151  16.440001  162.148941  127.592178  104.780792  103.075020   
 
           ABT         ACN        ADBE         ADI  ...         COF        CPB  \
 5  108.607231  258.567596  485.100006  151.978760  ...  107.090172  44.632610   
 6  107.857925  254.838257  474.239990  153.491379  ...  105.879402  43.842060   
 7  105.911751  252.929520  471.649994  154.257385  ...  107.283897  43.327728   
 8  109.132690  252.497345  472.049988  153.665878  ...  108.562469  43.270580   
 9  107.510841  250.454453  463.269989  154.616150  ...  110.809662  43.689663   
 
         GOOG      GOOGL        HRB         KMX        LNT         MMM  \
 5  90.360497  89.891502  14.834742  102.099998  46.888130  156.738998   
 6  88.335999  87.814499  15.039871  104.639999  46.128044  155.403214   
 7  87.327499  86.871498  15.254329  106.500000  45.633984  156.635513   
 8  87.720001  87.362503  15.328922  105.489998  46.318062  156.419174   
 9  87.009003  86.545998  15.030549  106.349998  45.690994  156.541443   
 
           MO          T  
 5  36.512535  19.315926  
 6  36.301834  19.216084  
 7  35.933102  19.136213  
 8  36.073574  19.043026  
 9  36.091137  19.495638  
 
 [5 rows x 82 columns],
              A    AAL         AAP        AAPL        ABBV         ABC  \
 10  125.112587  15.76  158.710587  125.840279  103.738899  104.206856   
 11  126.242676  15.97  159.363693  126.523224  105.297058  100.986992   
 12  126.996071  16.17  158.643356  130.680298  105.710068  101.269943   
 13  125.895721  15.83  160.084000  135.470825  104.433502  102.362747   
 14  125.231560  15.82  157.279556  137.648331  104.058044  105.143555   
 
            ABT         ACN        ADBE         ADI  ...         COF  \
 10  108.741890  249.128510  458.079987  152.958054  ...  108.998352   
 11  109.982697  251.279465  456.500000  155.663315  ...  109.318008   
 12  110.295341  257.005585  469.730011  154.974899  ...  107.884445   
 13  110.353951  253.342056  472.019989  154.451263  ...  105.133575   
 14  110.246475  250.228546  472.440002  150.853989  ...  102.033997   
 
           CPB       GOOG      GOOGL        HRB         KMX        LNT  \
 10  44.213520  86.809502  86.380997  15.384866  106.440002  47.002148   
 11  44.175426  89.542999  89.223503  15.300949  116.430000  47.154167   
 12  43.851585  94.345001  94.003502  15.739184  122.790001  47.429699   
 13  44.404015  94.562500  94.207497  15.543377  120.290001  47.268185   
 14  44.365921  95.052498  94.627998  15.552705  118.639999  46.945145   
 
            MMM         MO          T  
 10  155.732468  36.170151  19.415764  
 11  159.090759  36.196480  19.269331  
 12  160.125504  36.960270  19.275988  
 13  160.548859  36.819809  19.189459  
 14  159.015503  36.723236  19.256021  
 
 [5 rows x 82 columns],
              A        AAL         AAP        AAPL        ABBV         ABC  \
 15  124.388947  15.430000  153.341812  141.458969  103.720131  104.275162   
 16  122.842499  15.530000  151.392151  141.696518  102.124435  106.197319   
 17  117.767021  16.559999  142.075989  140.607758   96.483185  104.245872   
 18  120.503014  18.100000  147.271912  135.688553   97.816055  104.304436   
 19  119.125107  17.170000  143.238129  130.610992   96.192200  101.669983   
 
            ABT         ACN        ADBE         ADI  ...         COF  \
 15  112.083290  247.547195  473.440002  149.050476  ...   99.312195   
 16  112.093063  248.480270  476.279999  150.233444  ...   96.793793   
 17  111.663170  241.713120  460.000000  143.000000  ...   99.467178   
 18  117.622963  244.895340  465.670013  144.677505  ...  103.486916   
 19  120.749405  237.607605  458.769989  142.854599  ...  100.987907   
 
           CPB       GOOG      GOOGL        HRB         KMX        LNT  \
 15  45.718422  94.970001  94.713997  15.748508  120.959999  47.980766   
 16  47.575733  95.862000  95.397499  17.193754  127.790001  47.353687   
 17  50.204540  91.539497  90.946999  17.324293  121.449997  46.536594   
 18  46.432774  93.155502  92.660004  16.391876  121.290001  46.903496   
 19  45.823193  91.787003  91.367996  16.065533  117.779999  46.606525   
 
            MMM         MO          T  
 15  160.285446  36.837360  19.375828  
 16  165.515717  37.074402  19.801819  
 17  175.581161  36.714451  19.395798  
 18  172.542725  37.443130  19.169491  
 19  165.242905  36.064796  19.056337  
 
 [5 rows x 82 columns]]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20" id="F2PjdKHW8zXX">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> []</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> formatter(data,tmp):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> data.columns:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>      new <span class="op">=</span> []</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> j <span class="kw">in</span> data[i].iteritems():</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>          new.append([j[<span class="dv">1</span>]])</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      tmp.append(new)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> tmp</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21" id="x3gRVyJC8-If">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>listing <span class="op">=</span> []</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> df_list:</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="op">=</span> []</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  res <span class="op">=</span> formatter(i,tmp)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  listing.append(tmp)</span></code></pre></div>
</div>
<div class="cell code" id="8zcthMmc9BCW">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>clustering_result <span class="op">=</span> []</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>clustering_result.append(data.columns.tolist())</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>trainer <span class="op">=</span> []</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>kms <span class="op">=</span> []</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> listing:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  X_train <span class="op">=</span> TimeSeriesScalerMeanVariance().fit_transform(i)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  X_train <span class="op">=</span> TimeSeriesResampler(sz<span class="op">=</span><span class="dv">100</span>).fit_transform(X_train)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  trainer.append(X_train)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  sz <span class="op">=</span> X_train.shape[<span class="dv">1</span>]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  km <span class="op">=</span> TimeSeriesKMeans(n_clusters<span class="op">=</span><span class="dv">12</span>,metric<span class="op">=</span><span class="st">&quot;dtw&quot;</span>, max_iter<span class="op">=</span><span class="dv">15</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  kms.append(km)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="op">=</span> km.fit_predict(X_train)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  clustering_result.append(y_pred)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23" data-colab="{&quot;height&quot;:204,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="-2kfwbFv9GO2" data-outputId="3b9585c7-dbdd-4c16-94b4-c43a4e26840f">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(clustering_result)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df, df.columns <span class="op">=</span> df[<span class="dv">1</span>:] , df.iloc[<span class="dv">0</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">

  <div id="df-40627a03-477d-4f16-a682-94231e4a3e6d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>AAL</th>
      <th>AAP</th>
      <th>AAPL</th>
      <th>ABBV</th>
      <th>ABC</th>
      <th>ABT</th>
      <th>ACN</th>
      <th>ADBE</th>
      <th>ADI</th>
      <th>...</th>
      <th>COF</th>
      <th>CPB</th>
      <th>GOOG</th>
      <th>GOOGL</th>
      <th>HRB</th>
      <th>KMX</th>
      <th>LNT</th>
      <th>MMM</th>
      <th>MO</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>10</td>
      <td>7</td>
      <td>9</td>
      <td>10</td>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>...</td>
      <td>7</td>
      <td>1</td>
      <td>9</td>
      <td>9</td>
      <td>11</td>
      <td>2</td>
      <td>10</td>
      <td>6</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>5</td>
      <td>11</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>9</td>
      <td>11</td>
      <td>...</td>
      <td>8</td>
      <td>3</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>10</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 82 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-40627a03-477d-4f16-a682-94231e4a3e6d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-40627a03-477d-4f16-a682-94231e4a3e6d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-40627a03-477d-4f16-a682-94231e4a3e6d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="24" id="m9pe4RFs9ZG3">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="25" data-colab="{&quot;height&quot;:761,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="EloffzjL9am_" data-outputId="d8b55ae1-10b0-4d8d-ceab-345c1eb11aec">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>weeks <span class="op">=</span> <span class="bu">len</span>(df)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>filenames <span class="op">=</span> []</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> week <span class="kw">in</span> <span class="bu">range</span>(weeks<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> yi <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>):</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      plt.subplot(<span class="dv">3</span>, <span class="dv">4</span>, yi <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> xx <span class="kw">in</span> trainer[week][y_pred <span class="op">==</span> yi]:</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>          plt.plot(xx.ravel(), <span class="st">&quot;k-&quot;</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      plt.plot(kms[week].cluster_centers_[yi].ravel(), <span class="st">&quot;r-&quot;</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>      plt.xlim(<span class="dv">0</span>, sz)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>      plt.ylim(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      plt.text(<span class="fl">0.55</span>, <span class="fl">0.85</span>,<span class="st">&#39;Cluster </span><span class="sc">%d</span><span class="st">&#39;</span> <span class="op">%</span> (yi <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>              transform<span class="op">=</span>plt.gca().transAxes)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>      filename <span class="op">=</span> <span class="ss">f&#39;</span><span class="sc">{</span>week<span class="sc">}</span><span class="ss">.png&#39;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>      filenames.append(filename)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  plt.savefig(filename)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_6a25186fea2d4bfda17c7d27b8e301d8/0953a391cb3a818fcfd61aa38e2e0ba6c1b0879d.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_6a25186fea2d4bfda17c7d27b8e301d8/4a52b356b5fe3a8050e181ef541b8a8e38487b0b.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_6a25186fea2d4bfda17c7d27b8e301d8/3432438619af7c73d05edd6bdce438948912131e.png" /></p>
</div>
</div>
<div class="cell code" id="Vh6Ow1nH-FL3">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
